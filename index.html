<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat Assistant</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/5.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://unpkg.com/typescript@5.2.2/lib/typescript.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Floating Sidebar Toggle for Desktop -->
        <button class="sidebar-toggle-desktop" id="sidebarToggleDesktop">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-robot"></i> AI Assistant</h2>
                <button class="toggle-sidebar" id="toggleSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="sidebar-content">
                <button class="new-chat-btn" id="newChatBtn">
                    <i class="fas fa-plus"></i>
                    Новый чат
                </button>

                <div class="chat-history" id="chatHistory">
                    <!-- Chat history items will be populated by JavaScript -->
                </div>
            </div>

            <div class="sidebar-footer">
                <button class="settings-btn" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                    Настройки
                </button>
            </div>
        </div>

        <!-- Main content -->
        <div class="main-content">
            <div class="chat-container" id="chatContainer">
                <!-- Chat Header -->
                <div class="chat-header">
                    <button class="sidebar-toggle-mobile" id="sidebarToggleMobile">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h3 id="chatTitle">AI Assistant</h3>
                    <div class="chat-controls">
                        <button class="clear-chat-btn" id="clearChatBtn" title="Очистить чат">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>

                <!-- Messages container -->
                <div class="chat-messages" id="chatMessages">
                    <!-- Messages will be populated by JavaScript -->
                </div>

                <!-- Typing indicator -->
                <div class="typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="message assistant">
                        <div class="message-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <div class="typing-dots">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input container -->
                <div class="input-container">
                    <!-- File upload area -->
                    <div class="file-upload-area" id="fileUploadArea" style="display: none;">
                        <div class="uploaded-files" id="uploadedFiles">
                            <!-- Uploaded files will be shown here -->
                        </div>
                    </div>

                    <!-- Input wrapper -->
                    <div class="input-wrapper">
                        <div class="input-actions">
                            <input type="file" id="fileInput" multiple accept="*/*" style="display: none;">
                            <button class="file-btn" onclick="document.getElementById('fileInput').click()">
                                <i class="fas fa-paperclip"></i>
                            </button>
                        </div>

                        <textarea
                                id="messageInput"
                                placeholder="Напишите сообщение..."
                                rows="1"
                                maxlength="10000"
                        ></textarea>

                        <button class="send-btn" id="sendBtn" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Artifacts Panel -->
            <div class="artifacts-panel" id="artifactsPanel">
                <div class="artifacts-header">
                    <h3 id="artifactTitle">Артефакт</h3>
                    <div class="artifacts-controls">
                        <button class="control-btn" id="fullscreenBtn" title="Полноэкранный режим">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="control-btn" id="closeArtifactsBtn" title="Закрыть">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <div class="artifacts-tabs">
                    <button class="tab-btn active" data-tab="preview" id="previewTab">
                        <i class="fas fa-eye"></i> Предпросмотр
                    </button>
                    <button class="tab-btn" data-tab="code" id="codeTab">
                        <i class="fas fa-code"></i> Код
                    </button>
                    <button class="tab-btn" data-tab="playground" id="playgroundTab">
                        <i class="fas fa-play"></i> Playground
                    </button>
                </div>

                <div class="artifacts-content">
                    <!-- Preview Tab -->
                    <div class="tab-content active" id="previewContent">
                        <div class="preview-container">
                            <!-- HTML/Web preview -->
                            <iframe id="previewFrame" class="preview-frame" sandbox="allow-scripts allow-same-origin"></iframe>

                            <!-- Image preview -->
                            <div id="imagePreview" class="image-preview" style="display: none;">
                                <img id="artifactImage" alt="Artifact image">
                                <div class="image-controls">
                                    <button id="zoomInBtn"><i class="fas fa-search-plus"></i></button>
                                    <button id="zoomOutBtn"><i class="fas fa-search-minus"></i></button>
                                    <button id="resetZoomBtn"><i class="fas fa-undo"></i></button>
                                </div>
                            </div>

                            <!-- Media preview -->
                            <div id="mediaPreview" class="media-preview" style="display: none;">
                                <video id="mediaPlayer" controls style="display: none;"></video>
                                <audio id="audioPlayer" controls style="display: none;"></audio>
                            </div>
                        </div>
                    </div>

                    <!-- Code Tab -->
                    <div class="tab-content" id="codeContent">
                        <div class="code-header">
                            <select id="languageSelect" class="language-select">
                                <option value="javascript">JavaScript</option>
                                <option value="typescript">TypeScript</option>
                                <option value="html">HTML</option>
                                <option value="css">CSS</option>
                                <option value="python">Python</option>
                                <option value="json">JSON</option>
                                <option value="markdown">Markdown</option>
                                <option value="plaintext">Plain Text</option>
                            </select>
                            <div class="code-actions">
                                <button id="copyCodeBtn" class="action-btn">
                                    <i class="fas fa-copy"></i> Копировать
                                </button>
                                <button id="downloadBtn" class="action-btn">
                                    <i class="fas fa-download"></i> Скачать
                                </button>
                            </div>
                        </div>
                        <div class="code-editor-container">
                            <pre id="codeEditor"><code></code></pre>
                        </div>
                    </div>

                    <!-- Playground Tab -->
                    <div class="tab-content" id="playgroundContent">
                        <div class="playground-tabs">
                            <button class="playground-tab-btn active" data-lang="html">HTML</button>
                            <button class="playground-tab-btn" data-lang="css">CSS</button>
                            <button class="playground-tab-btn" data-lang="js">JS</button>
                            <button class="playground-tab-btn" data-lang="ts">TS</button>
                        </div>

                        <div class="playground-editors">
                            <div class="playground-editor active" id="htmlEditor">
                                <textarea placeholder="HTML код..."></textarea>
                            </div>
                            <div class="playground-editor" id="cssEditor">
                                <textarea placeholder="CSS стили..."></textarea>
                            </div>
                            <div class="playground-editor" id="jsEditor">
                                <textarea placeholder="JavaScript код..."></textarea>
                            </div>
                            <div class="playground-editor" id="tsEditor">
                                <textarea placeholder="TypeScript код..."></textarea>
                            </div>
                        </div>

                        <div class="playground-controls">
                            <button id="runCodeBtn" class="run-btn">
                                <i class="fas fa-play"></i> Запустить
                            </button>
                            <button id="clearPlaygroundBtn" class="clear-btn">
                                <i class="fas fa-trash"></i> Очистить
                            </button>
                        </div>

                        <div class="playground-output">
                            <iframe id="playgroundFrame" class="playground-frame" sandbox="allow-scripts allow-same-origin"></iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Настройки</h3>
                <button class="close-modal" id="closeSettingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label for="webhookUrl">Webhook URL</label>
                    <input type="url" id="webhookUrl" placeholder="https://your-api-endpoint.com/chat" required>
                    <small class="form-help">URL вашего API endpoint для отправки сообщений</small>
                </div>

                <div class="form-group">
                    <label for="apiKey">API Key (опционально)</label>
                    <input type="password" id="apiKey" placeholder="Введите API ключ">
                    <small class="form-help">API ключ для авторизации запросов</small>
                </div>

                <div class="form-group">
                    <label for="modelName">Модель</label>
                    <select id="modelName">
                        <option value="gpt-4">GPT-4</option>
                        <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                        <option value="claude-3-opus">Claude 3 Opus</option>
                        <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                        <option value="claude-3-haiku">Claude 3 Haiku</option>
                        <option value="gemini-pro">Gemini Pro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="enableStreaming">
                        <span class="checkmark"></span>
                        Включить потоковую передачу
                    </label>
                    <small class="form-help">Получать ответы в реальном времени</small>
                </div>

                <div class="form-group">
                    <label for="maxTokens">Максимум токенов</label>
                    <input type="number" id="maxTokens" value="2048" min="1" max="8192">
                    <small class="form-help">Максимальное количество токенов в ответе</small>
                </div>

                <div class="form-group">
                    <label for="temperature">Температура</label>
                    <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7">
                    <span id="temperatureValue">0.7</span>
                    <small class="form-help">Контролирует креативность ответов (0 - точность, 2 - креативность)</small>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" id="cancelSettingsBtn">Отмена</button>
                <button class="btn-primary" id="saveSettingsBtn">Сохранить</button>
            </div>
        </div>
    </div>

    <!-- Toast notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="script.js"></script>
</body>
</html>
